<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AquaCoach - Planning des Cours de Natation</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Menu lat√©ral pour les r√©f√©rentiels -->
    <div id="sideMenu" class="side-menu">
        <div class="menu-header">
            <h3><i class="fas fa-cogs"></i> R√©f√©rentiels</h3>
            <button id="closeSideMenu" class="close-menu-btn">&times;</button>
        </div>
        <div class="menu-content">
            <div class="menu-section">
                <button id="manageEmployeesBtn" class="menu-btn">
                    <i class="fas fa-chalkboard-teacher"></i> G√©rer les coachs
                </button>
                <button id="manageLocationsBtn" class="menu-btn">
                    <i class="fas fa-swimming-pool"></i> G√©rer les bassins
                </button>
            </div>
            <div class="menu-section">
                <button id="manageTemplateBtn" class="menu-btn">
                    <i class="fas fa-calendar-plus"></i> Semaine type
                </button>
                <button id="dashboardBtn" class="menu-btn">
                    <i class="fas fa-chart-dashboard"></i> Tableau de bord
                </button>
                <button id="exportPDF" class="menu-btn">
                    <i class="fas fa-file-pdf"></i> Exporter en PDF
                </button>
            </div>
        </div>
    </div>

    <!-- Overlay pour le menu -->
    <div id="menuOverlay" class="menu-overlay"></div>

    <!-- Header -->
    <header class="app-header">
        <div class="header-content">
            <button id="openSideMenu" class="menu-toggle-btn">
                <i class="fas fa-bars"></i>
            </button>
            <h1><i class="fas fa-chalkboard-teacher"></i> AquaCoach - Planning des Cours de Natation</h1>
            <div class="header-controls">
                <div class="view-toggle">
                    <button id="viewByPersonBtn" class="view-btn active">
                        <i class="fas fa-chalkboard-teacher"></i> Par Coach
                    </button>
                    <button id="viewByLocationBtn" class="view-btn">
                        <i class="fas fa-swimming-pool"></i> Par Bassin
                    </button>
                </div>
                                <button id="exportPdfBtn" class="header-btn">
                    <i class="fas fa-file-pdf"></i> Export PDF
                </button>
            </div>
        </div>
    </header>

    <!-- Navigation semaine -->
    <nav class="week-navigation">
        <button id="prevWeekBtn" class="nav-btn">
            <i class="fas fa-chevron-left"></i> Semaine pr√©c√©dente
        </button>
        <div class="current-week-info">
            <span id="currentWeekText">Chargement...</span>
        </div>
        <div class="week-controls">
            <button id="currentWeekBtn" class="current-week-btn">
                <i class="fas fa-calendar-week"></i>
                Semaine courante
            </button>
            <div class="template-actions">
                <button id="applyTemplateBtn" class="apply-template-btn">
                    <i class="fas fa-copy"></i>
                    Appliquer la semaine type
                </button>
            </div>
        </div>
        <button id="nextWeekBtn" class="nav-btn">
            Semaine suivante <i class="fas fa-chevron-right"></i>
        </button>
    </nav>

    <!-- Contenu principal -->
    <main class="main-content">
        <!-- Loading -->
        <div id="loadingSpinner" class="loading-spinner">
            <i class="fas fa-spinner fa-spin"></i> Chargement du planning...
        </div>

        <!-- Vue par personne -->
        <div id="personView" class="planning-view active">
            <div class="planning-grid">
                            <div class="grid-header">
                <div class="person-column-header">Coach</div>
                <div class="day-header">üèä‚Äç‚ôÄÔ∏è Lundi</div>
                <div class="day-header">ü§Ω‚Äç‚ôÇÔ∏è Mardi</div>
                <div class="day-header">üèÑ‚Äç‚ôÄÔ∏è Mercredi</div>
                <div class="day-header">üö£‚Äç‚ôÇÔ∏è Jeudi</div>
                <div class="day-header">üèä‚Äç‚ôÇÔ∏è Vendredi</div>
                <div class="day-header">üèñÔ∏è Samedi</div>
                <div class="day-header">üåä Dimanche</div>
            </div>
                <div id="planningGridContent" class="grid-content">
                    <!-- Contenu g√©n√©r√© dynamiquement -->
                </div>
            </div>
        </div>

        <!-- Vue par lieu -->
        <div id="locationView" class="planning-view">
            <div class="location-planning">
                <div id="locationPlanningContent">
                    <!-- Contenu g√©n√©r√© dynamiquement -->
                </div>
            </div>
        </div>
    </main>

    <!-- Modal d'√©dition de cr√©neau -->
    <div id="editSlotModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-edit"></i> √âditer un cr√©neau</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="slotForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Coach:</label>
                            <select id="slotPerson" required>
                                <option value="">S√©lectionner un coach...</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Jour:</label>
                            <input type="date" id="slotDate" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Heure d√©but:</label>
                            <input type="time" id="slotStartTime" required>
                        </div>
                        <div class="form-group">
                            <label>Heure fin:</label>
                            <input type="time" id="slotEndTime" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Bassin:</label>
                        <select id="slotLocation" required>
                            <option value="">S√©lectionner un bassin...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Type de cours:</label>
                        <select id="slotCourseType">
                            <option value="">S√©lectionner le type de cours...</option>
                            <option value="natation-debutant">Natation d√©butant</option>
                            <option value="natation-perfectionnement">Natation perfectionnement</option>
                            <option value="aqua-fitness">Aqua fitness</option>
                            <option value="aqua-gym">Aqua gym</option>
                            <option value="ecole-de-nage">√âcole de nage (enfants)</option>
                            <option value="water-polo">Water polo</option>
                            <option value="natation-synchronisee">Natation synchronis√©e</option>
                            <option value="plongee">Plong√©e</option>
                            <option value="sauvetage">Sauvetage aquatique</option>
                            <option value="cours-prive">Cours priv√©</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Notes (optionnel):</label>
                        <textarea id="slotDescription" rows="3" placeholder="Mat√©riel n√©cessaire, nombre d'√©l√®ves, niveau requis..."></textarea>
                    </div>
                    <div class="form-actions">
                        <button type="button" id="deleteSlotBtn" class="btn-danger">
                            <i class="fas fa-trash"></i> Supprimer
                        </button>
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Sauvegarder
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal d'ajout de cr√©neau -->
    <div id="addSlotModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-plus-circle"></i> Ajouter un cr√©neau</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="addSlotForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Coach:</label>
                            <select id="addSlotPerson" required>
                                <option value="">S√©lectionner un coach...</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Jour:</label>
                            <input type="date" id="addSlotDate" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Heure d√©but:</label>
                            <input type="time" id="addSlotStartTime" required>
                        </div>
                        <div class="form-group">
                            <label>Heure fin:</label>
                            <input type="time" id="addSlotEndTime" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Bassin:</label>
                        <select id="addSlotLocation" required>
                            <option value="">S√©lectionner un bassin...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Type de cours:</label>
                        <select id="addSlotCourseType" required>
                            <option value="">S√©lectionner le type de cours...</option>
                            <option value="natation-debutant">Natation d√©butant</option>
                            <option value="natation-perfectionnement">Natation perfectionnement</option>
                            <option value="aqua-fitness">Aqua fitness</option>
                            <option value="aqua-gym">Aqua gym</option>
                            <option value="ecole-de-nage">√âcole de nage (enfants)</option>
                            <option value="water-polo">Water polo</option>
                            <option value="natation-synchronisee">Natation synchronis√©e</option>
                            <option value="plongee">Plong√©e</option>
                            <option value="sauvetage">Sauvetage aquatique</option>
                            <option value="cours-prive">Cours priv√©</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Notes (optionnel):</label>
                        <textarea id="addSlotDescription" rows="3" placeholder="Mat√©riel n√©cessaire, nombre d'√©l√®ves, niveau requis..."></textarea>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn-secondary" onclick="closeModal('addSlotModal')">
                            <i class="fas fa-times"></i> Annuler
                        </button>
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Ajouter le cr√©neau
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal de configuration email -->
    <div id="emailConfigModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-envelope"></i> Configuration Email</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="emailForm">
                    <div class="form-group">
                        <label>Destinataires (s√©par√©s par des virgules):</label>
                        <input type="email" id="emailRecipients" multiple required 
                               placeholder="email1@exemple.com, email2@exemple.com">
                    </div>
                    <div class="form-group">
                        <label>Objet:</label>
                        <input type="text" id="emailSubject" required 
                               value="Planning de la semaine">
                    </div>
                    <div class="form-group">
                        <label>Message:</label>
                        <textarea id="emailMessage" rows="4" 
                                  placeholder="Bonjour, veuillez trouver en pi√®ce jointe le planning de la semaine."></textarea>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn-secondary" onclick="closeModal('emailConfigModal')">
                            Annuler
                        </button>
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-paper-plane"></i> Envoyer PDF
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal de gestion des coachs -->
    <div id="employeeManagementModal" class="modal large-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-chalkboard-teacher"></i> Gestion des Coachs</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="management-controls">
                    <button id="addEmployeeBtn" class="btn-primary">
                        <i class="fas fa-plus"></i> Ajouter un coach
                    </button>
                </div>
                <div class="employees-list">
                    <table id="employeesTable" class="data-table">
                        <thead>
                            <tr>
                                <th>Nom</th>
                                <th>Pr√©nom</th>
                                <th>Email</th>
                                <th>T√©l√©phone</th>
                                <th>Sp√©cialit√©</th>
                                <th>Actif</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="employeesTableBody">
                            <!-- Contenu g√©n√©r√© dynamiquement -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal d'√©dition de coach -->
    <div id="editEmployeeModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-chalkboard-teacher"></i> <span id="employeeModalTitle">Ajouter un coach</span></h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="employeeForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Nom:</label>
                            <input type="text" id="employeeLastName" placeholder="Nom de famille">
                        </div>
                        <div class="form-group">
                            <label>Pr√©nom:</label>
                            <input type="text" id="employeeFirstName" placeholder="Pr√©nom">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Adresse email:</label>
                            <input type="email" id="employeeEmail" placeholder="coach@piscine.com">
                        </div>
                        <div class="form-group">
                            <label>T√©l√©phone:</label>
                            <input type="tel" id="employeePhone" placeholder="01 23 45 67 89">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Sp√©cialit√©:</label>
                        <select id="employeeSpecialty">
                            <option value="">S√©lectionner une sp√©cialit√©</option>
                            <option value="natation-adulte">Natation adulte</option>
                            <option value="natation-enfant">Natation enfant</option>
                            <option value="aqua-fitness">Aqua fitness</option>
                            <option value="water-polo">Water polo</option>
                            <option value="plongee">Plong√©e</option>
                            <option value="sauvetage">Sauvetage aquatique</option>
                            <option value="natation-synchronisee">Natation synchronis√©e</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="employeeActive" checked>
                            <span class="checkmark"></span>
                            Coach actif
                        </label>
                    </div>
                    <div class="form-actions">
                        <button type="button" id="deleteEmployeeBtn" class="btn-danger" style="display: none;">
                            <i class="fas fa-trash"></i> Supprimer
                        </button>
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Sauvegarder
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal de gestion des bassins -->
    <div id="locationManagementModal" class="modal large-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-swimming-pool"></i> Gestion des Bassins</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="management-controls">
                    <button id="addLocationBtn" class="btn-primary">
                        <i class="fas fa-plus"></i> Ajouter un bassin
                    </button>
                </div>
                <div class="locations-list">
                    <table id="locationsTable" class="data-table">
                        <thead>
                            <tr>
                                <th>Nom du bassin</th>
                                <th>Localisation</th>
                                <th>Caract√©ristiques</th>
                                <th>Cours possibles</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="locationsTableBody">
                            <!-- Contenu g√©n√©r√© dynamiquement -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal d'√©dition de bassin -->
    <div id="editLocationModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-swimming-pool"></i> <span id="locationModalTitle">Ajouter un bassin</span></h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="locationForm">
                    <div class="form-group">
                        <label>Nom du bassin:</label>
                        <input type="text" id="locationName" placeholder="Ex: Bassin olympique, Bassin enfants..." required>
                    </div>
                    <div class="form-group">
                        <label>Localisation:</label>
                        <textarea id="locationAddress" rows="2" placeholder="Centre aquatique, Hall principal, Espace d√©tente..."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Caract√©ristiques:</label>
                        <textarea id="locationCharacteristics" rows="3" placeholder="Dimensions, profondeur, temp√©rature, √©quipements..."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Cours possibles:</label>
                        <textarea id="locationActivities" rows="3" placeholder="Types de cours qui peuvent √™tre donn√©s dans ce bassin..."></textarea>
                    </div>
                    <div class="form-actions">
                        <button type="button" id="deleteLocationBtn" class="btn-danger" style="display: none;">
                            <i class="fas fa-trash"></i> Supprimer
                        </button>
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Sauvegarder
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal de gestion de la semaine type -->
    <div id="templateManagementModal" class="modal large-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-calendar-plus"></i> Semaine Type</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="template-info">
                    <p><strong>Semaine type :</strong> Mod√®le de planning hebdomadaire avec tous les coachs actifs</p>
                </div>
                
                <div class="modal-section">
                    <div class="section-header">
                        <h4>Planification</h4>
                        <button id="createTemplateBtn" class="btn primary">
                            <i class="fas fa-plus"></i> Cr√©er/Modifier la semaine type
                        </button>
                    </div>
                </div>
                
                <div id="templateView" class="template-planning" style="display: none;">
                    <div class="planning-grid">
                        <div class="grid-header">
                            <div class="person-column-header">Coach</div>
                            <div class="day-header">üèä‚Äç‚ôÄÔ∏è Lundi</div>
                            <div class="day-header">ü§Ω‚Äç‚ôÇÔ∏è Mardi</div>
                            <div class="day-header">üèÑ‚Äç‚ôÄÔ∏è Mercredi</div>
                            <div class="day-header">üö£‚Äç‚ôÇÔ∏è Jeudi</div>
                            <div class="day-header">üèä‚Äç‚ôÇÔ∏è Vendredi</div>
                            <div class="day-header">üèñÔ∏è Samedi</div>
                            <div class="day-header">üåä Dimanche</div>
                        </div>
                        <div id="templateGridContent" class="grid-content">
                            <!-- Contenu g√©n√©r√© dynamiquement -->
                        </div>
                    </div>
                    
                    <div class="template-actions-footer">
                        <button id="saveTemplateBtn" class="btn success">
                            <i class="fas fa-save"></i> Sauvegarder la semaine type
                        </button>
                        <button id="clearTemplateBtn" class="btn danger">
                            <i class="fas fa-trash"></i> Vider la semaine type
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal du tableau de bord -->
    <div id="dashboardModal" class="modal large-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-chart-dashboard"></i> Tableau de Bord</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <div class="card-header">
                            <h4><i class="fas fa-clock"></i> Statistiques de la semaine</h4>
                        </div>
                        <div class="card-body" id="weekStats">
                            <!-- Contenu g√©n√©r√© dynamiquement -->
                        </div>
                    </div>
                    
                    <div class="dashboard-card">
                        <div class="card-header">
                            <h4><i class="fas fa-exclamation-triangle"></i> Conflits d√©tect√©s</h4>
                        </div>
                        <div class="card-body" id="conflictsList">
                            <!-- Contenu g√©n√©r√© dynamiquement -->
                        </div>
                    </div>
                    
                    <div class="dashboard-card">
                        <div class="card-header">
                            <h4><i class="fas fa-swimming-pool"></i> Occupation des bassins</h4>
                        </div>
                        <div class="card-body" id="poolOccupancy">
                            <!-- Contenu g√©n√©r√© dynamiquement -->
                        </div>
                    </div>
                    
                    <div class="dashboard-card">
                        <div class="card-header">
                            <h4><i class="fas fa-user-clock"></i> Heures par coach</h4>
                        </div>
                        <div class="card-body" id="coachHours">
                            <!-- Contenu g√©n√©r√© dynamiquement -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de facturation -->
    <div id="billingModal" class="modal large-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-euro-sign"></i> Facturation - Semaine</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="billing-controls">
                    <div class="period-info">
                        <h4 id="billingPeriodTitle">Facturation de la semaine courante</h4>
                        <p id="billingDateRange"></p>
                    </div>
                    <div class="billing-actions">
                        <button class="btn-primary" onclick="planningManager.exportBillingPDF()">
                            <i class="fas fa-file-pdf"></i> Exporter PDF
                        </button>
                    </div>
                </div>
                <div class="billing-content">
                    <div class="billing-summary">
                        <div class="summary-card primary">
                            <div class="summary-icon"><i class="fas fa-clock"></i></div>
                            <div class="summary-info">
                                <div class="summary-value" id="totalHoursBilling">0h</div>
                                <div class="summary-label">Total heures</div>
                            </div>
                        </div>
                        <div class="summary-card success">
                            <div class="summary-icon"><i class="fas fa-calendar-check"></i></div>
                            <div class="summary-info">
                                <div class="summary-value" id="totalSlotsBilling">0</div>
                                <div class="summary-label">Total cr√©neaux</div>
                            </div>
                        </div>
                        <div class="summary-card info">
                            <div class="summary-icon"><i class="fas fa-user-friends"></i></div>
                            <div class="summary-info">
                                <div class="summary-value" id="activeCoachesBilling">0</div>
                                <div class="summary-label">Coachs actifs</div>
                            </div>
                        </div>
                        <div class="summary-card warning">
                            <div class="summary-icon"><i class="fas fa-euro-sign"></i></div>
                            <div class="summary-info">
                                <div class="summary-value" id="totalAmountBilling">0 ‚Ç¨</div>
                                <div class="summary-label">Montant total</div>
                            </div>
                        </div>
                    </div>
                    <div class="billing-table-container">
                        <table class="billing-table">
                            <thead>
                                <tr>
                                    <th class="coach-column">Coach</th>
                                    <th class="specialty-column">Sp√©cialit√©</th>
                                    <th class="hours-column">Total Heures</th>
                                    <th class="slots-column">Cr√©neaux</th>
                                    <th class="rate-column">Taux/h</th>
                                    <th class="total-column">Total ‚Ç¨</th>
                                </tr>
                            </thead>
                            <tbody id="billingTableBody">
                                <!-- Les donn√©es de facturation seront g√©n√©r√©es ici -->
                            </tbody>
                            <tfoot>
                                <tr class="billing-total">
                                    <td colspan="2"><strong>TOTAL G√âN√âRAL</strong></td>
                                    <td><strong id="grandTotalHours">0h</strong></td>
                                    <td><strong id="grandTotalSlots">0</strong></td>
                                    <td>-</td>
                                    <td><strong id="grandTotalAmount">0 ‚Ç¨</strong></td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Status bar -->
    <div id="statusBar" class="status-bar">
        <span id="statusText">Pr√™t</span>
    </div>

    <script src="script-fixed.js"></script>
</body>
</html>